# I know English bot
## Описание
I_know_english_bot - это Telegram-бот, который помогает пользователям учить английский язык, предоставляя функции добавления слов в словарь, обучения, удаления слов и просмотра словаря. Бот использует базу данных для хранения информации о пользователях и словах.

>перед началом работы бота, создайте базу даных в терминале командой: ``createdb -U`` ***"ваш_логин_posgres"*** ***"ваше_имя_базы_данных"***

### Установите все необходимые зависимости с помощью команды:  
```pip install -r requirements.txt```

### Создайте файл .env для хранения переменных окружения:
TOKEN_TELEGRAM=ваш токен бота  
DB_TYPE=postgresql  
DB_LOGIN=ваш логин  
DB_PASSWORD=ваш пароль  
DB_NAME=ваше имя базы данных


## Директория tables
+ Фаил model.py:   
   +  Содержит модели (шаблоны) таблиц;
   +  Функции по работе с ними (создание и удаление).
+ Фаил common_words.py:
   +  Список общих слов для таблицы common_words

### DB имеет следующую структуру:
![](/pictures/i_know_english_bot_db.png "Визуализация DB")

### Dbeaver версия изображения:
![](/pictures/i_know_english_bot_db_dbeaver.png "Визуализация DB версия Dbeaver")

### Основные функции
`safe_commit(action)`: Безопасно выполняет переданное действие и обрабатывает ошибки, откатывая изменения в случае неудачи.

`add_user(user_id, username)`: Добавляет нового пользователя с указанным user_id и username в базу данных.

`add_word(word_ru, word_en, user_id)`: Добавляет новое слово на русском (word_ru) и английском (word_en) языках в таблицу слов и связывает его с пользователем по user_id.

`link_user_word(user_id, word_id)`: Связывает указанного пользователя с добавленным словом по их идентификаторам user_id и word_id.

`remove_word_from_dictionary(word_ru, user_id)`: Удаляет указанное слово на русском языке (word_ru) из словаря данного пользователя (user_id) и из базы данных, если слово не связано с другими пользователями.

`add_user_activity(user_id, activity_type)`: Записывает активность пользователя с указанным user_id и типом активности (activity_type) в таблицу активности пользователей.

`view_dictionary(user_id)`: Возвращает список слов, добавленных пользователем в словарь, на основе их идентификатора user_id.

`check_word_exists(word)`: Проверяет, существует ли указанное слово (word) в таблице слов в базе данных, возвращая True или False.

### Обработчики команд
`handle_main_buttons(message)`: Обрабатывает основные команды, такие как "Помощь", "Обучение", "Добавить слово" и "Удалить слово".  
`return_to_main_menu(message)`: Возвращает пользователя в главное меню.  
`handle_learning_choice(message)`: Выбирает случайные слова для обучения.  
`check_answer(message, correct_answer, word_options)`: Проверяет, правильный ли ответ дал пользователь.  
### Сохранение данных
`save_to_json(filename='data.json')`: Сохраняет данные из баз данных (пользователи, слова, активности) в указанном JSON-файле.  

### Пример использования
После запуска бота, пользователи могут отправлять команды, такие как:

`/start` - Приветственное сообщение и основное меню.  
`/help` - Просмотр доступных команд.  
`/add_word` - Добавление нового слова в словарь.  
`/remove_word` - Удаление слова из словаря.  
`/view_dictionary` - Просмотр своего словаря.  
